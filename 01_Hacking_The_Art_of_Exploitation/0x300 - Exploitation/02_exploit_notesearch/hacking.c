#include <stdio.h>

void usage(char *prog_name, char *filename) {
    
    printf("Usage: %s <data to add to %s>\n\n", prog_name, filename);
    exit(0);
}

void fatal(char *msg) {
    /* Display an error message and exit the program. */

    char error_msg[100];
    
    strcpy(error_msg, "[!!] Fatal Error: ");
    strncat(error_msg, msg, 84);
    perror(error_msg);
    exit(-1);
}

void *errorchecked_malloc(unsigned int size) {

    void *new_mem_addr;
    
    printf("\t[+] allocating %u bytes of memory.\n", size);
    
    /* Allocate the memory */
    new_mem_addr = malloc(size);
    
    /* Check that the allocation worked. */
    if (new_mem_addr == NULL) {
        fprintf(stderr, "Error: Memory could not be allocated!");
        exit(-1);
    }
    
    printf("\t[+] Memory located at address %p.\n\n", new_mem_addr);
    
    return new_mem_addr;
}

void safer_free(void **mem_address) {

    if (mem_address == NULL)
        printf("\t[-] pointer at %p is already NULL.\n", mem_address);
    
    else {
        printf("\t[-] freeing pointer at %p.\n", mem_address);
        free(*mem_address);
    }
}
